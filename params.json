{"name":"docs.gate2all","tagline":"JSR 356: JavaTM API for WebSocket","body":"---\r\ntitle: API Reference\r\n\r\nlanguage_tabs:\r\n  - xml\r\n  - php\r\n  - python\r\n\r\ntoc_footers:\r\n  - <a href='#'>Sign Up for a Developer Key</a>\r\n  - <a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a>\r\n\r\nincludes:\r\n  - errors\r\n\r\nsearch: true\r\n---\r\n\r\n# Gateway\r\n\r\nO GATE2all é uma ferramenta desenvolvida pela NTK Solutions que viabiliza transações para lojas\r\nvirtuais (e-commerce).\r\n\r\nA vantagem de se utilizar nossa ferramenta é que você não precisará se preocupar em afiliar sua\r\nempresa com diversas instituições financeiras, através do GATE2all você se beneficia delas de forma\r\nunificada e sem complicações.\r\n\r\n# GATE2all Loja\r\n\r\nNo modelo GATE2All Loja o usuário é redirecionado pela loja virtual ao gateway transacional no\r\nmomento da operação de pagamento.\r\n\r\n<img src=\"images/img2.png\">\r\n\r\nO GATE2all terá o logotipo fornecido pelo lojista, de forma que se mantenha a identidade visual da\r\nloja virtual.\r\n\r\nAo redirecionar o usuário ao GATE2all, a loja virtual envia uma mensagem contendo a URL à qual o\r\nusuário deve ser redirecionado quando do término da operação de pagamento.\r\n\r\nNeste modelo há necessidade de desenvolvimento de integração entre os sistemas da loja virtual e\r\ndo gateway transacional GATE2all, mas não há necessidade de desenvolvimento de telas ou campos\r\npara captura dos dados do usuário. Isto será feito diretamente pelo GATE2all. Também não há\r\nobrigação do uso de SSL por parte da loja virtual, tendo em vista que nenhum dado do usuário irá\r\ntrafegar por ela.\r\n\r\n## Fluxo da Transação\r\n\r\n1. Todo o processo que envolve a realização de um pedido (escolha do produto, carrinho de compras\r\ne cadastro do cliente) é executado dentro da loja virtual.\r\n2. No passo de pagamento, a loja virtual envia para o GATE2all o valor total do pedido, número\r\nmáximo de parcelas, URL para retorno e opcionalmente um número de documento (numeração de\r\ncontrole do lojista) através de um arquivo XML.\r\n3. O comprador é redirecionado para o ambiente do GATE2all onde será efetuada a captura dos\r\ndados do cartão.\r\n4. GATE2all valida os parâmetros recebidos na requisição.\r\n5. Em caso de sucesso ou falha na autenticação e validação da transação, o GATE2all irá redirecionar\r\no comprador para a URL de retorno.\r\n6. Loja virtual consulta GATE2all para verificar status da transação.\r\n\r\n## Observações\r\n* Não é verificado se a soma dos valores dos itens de pedido é igual ao valor total do pedido.\r\n* O valor dos parâmetros será truncado, caso sejam enviados com tamanho superior ao definido.\r\n\r\n> To authorize, use this code:\r\n\r\n```php\r\nrequire 'kittn'\r\n\r\napi = Kittn::APIClient.authorize!('meowmeowmeow')\r\n```\r\n\r\n```python\r\nimport kittn\r\n\r\napi = kittn.authorize('meowmeowmeow')\r\n```\r\n\r\n```xml\r\nimport kittn\r\n\r\napi = kittn.authorize('meowmeowmeow')\r\n```\r\n\r\n# GATE2all Integrado\r\n\r\nNeste modelo todo o relacionamento com o usuário é realizado pela loja virtual, inclusive eventual\r\ncaptura de dados de cartões de crédito. Portanto sua loja virtual deverá ser homologada PCI, para\r\nmaiores informações consulte o site https://www.pcisecuritystandards.org\r\n\r\n<img src=\"images/img1.png\">\r\n\r\nA loja virtual deve fazer a captura de todos os dados necessários e submetê-los ao adquirente via\r\ngateway transacional GATE2all. A resposta à solicitação será síncrona e instantânea.\r\n\r\nNeste modelo um maior desenvolvimento será necessário por parte do desenvolvedor da loja virtual.\r\nTendo este que, não só desenvolver as interfaces de captura dos dados da transação, como também,\r\na integração com o GATE2all.\r\n\r\n## Fluxo da Transação\r\n\r\n1. Todos os dados da venda e do comprador são capturados dentro da loja virtual e enviados para o\r\nGATE2all através de um XML.\r\n2. GATE2all envia a requisição ao adquirente.\r\n3. Adquirente retorna a resposta da autorização da transação para o GATE2all, através de um XML\r\nvia POST.\r\n4. GATE2all retorna resposta da requisição, também através de um XML via POST.\r\n\r\n## Aprovacao\r\n\r\n```php\r\n//PRODUCAO\r\n/*\r\n$urlGate2all = 'https://ntk2all.com.br';\r\n*/\r\n\r\n$urlGate2all = 'http://cert.gate2all.com.br';\r\n$usuarioGate2all = 'demo';\r\n$tokenGate2all = '3366';\r\n\r\n$tokenIntencaoGate2all = '3563f901-80af-48be-965e-207e15d55c1e';\r\n\r\n$xmlGate2all = '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\r\n<transacao>\r\n  <usuario>'.$usuarioGate2all.'</usuario>\r\n  <token>'.$tokenGate2all.'</token>\r\n  <tokenIntencao>'.$tokenIntencaoGate2all.'</tokenIntencao>\r\n  <numeroDocumento>123456789</numeroDocumento>\r\n  <tipoOperacao>1</tipoOperacao>\r\n  <valorTransacao>100</valorTransacao>\r\n  <parcelamentoAdm>S</parcelamentoAdm>\r\n  <qtdeParcelas>01</qtdeParcelas>\r\n  <moeda>986</moeda>\r\n  <captura>S</captura>\r\n  <cartao>\r\n    <numeroCartao>5549274013227390</numeroCartao>\r\n    <mesValidade>05</mesValidade>\r\n    <anoValidade>2020</anoValidade>\r\n    <codigoSeguranca>5644</codigoSeguranca>\r\n    <bandeira>AMEX</bandeira>\r\n  </cartao>\r\n  <comprador>\r\n    <enderecoIP>local</enderecoIP>\r\n    <nomePortadorCartao>RONERI GONCALVES</nomePortadorCartao>\r\n    <cpfPortadorCartao>34650046807</cpfPortadorCartao>\r\n    <dataNascimentoPortadorCartao>16/08/1979</dataNascimentoPortadorCartao>\r\n  </comprador>\r\n</transacao>';\r\n\r\n$curl = curl_init();\r\n\r\ncurl_setopt_array($curl, array(\r\n  CURLOPT_URL => $urlGate2all.\"/venda/integrado\",\r\n  CURLOPT_CUSTOMREQUEST => \"POST\",\r\n  CURLOPT_HTTPHEADER => array(\"content-type: application/x-www-form-urlencoded\"),\r\n  CURLOPT_POSTFIELDS => 'xml='.$xmlGate2all,\r\n  CURLOPT_TIMEOUT => 90,\r\n  CURLOPT_RETURNTRANSFER => true,\r\n));\r\n\r\n$response = curl_exec($curl);\r\n$err = curl_error($curl);\r\n\r\ncurl_close($curl);\r\n\r\nif ($err) {\r\n  echo \"<p>cURL Error #:\".$err.\"</p>\";\r\n} else {\r\n  echo \"<h3>Response: </h3>\";\r\n  highlight_string($response);\r\n\r\n  $objResponse = simplexml_load_string($response);\r\n  if ($objResponse->autorizacao) {\r\n    $codResposta = $objResponse->autorizacao->codResposta;\r\n    $message = $objResponse->autorizacao->message;\r\n    $id_transacao = $objResponse->autorizacao->id_transacao;\r\n    if ($codResposta == \"00\") {\r\n      echo \"<p style='color:green'>\".$codResposta.\" : \".$message.\"</p>\";\r\n\r\n      $tid = $objResponse->autorizacao->tid;\r\n      echo \"<p>Ref. Host : \".$tid.\"</p>\";\r\n      $codAutorizacao = $objResponse->autorizacao->codAutorizacao;\r\n      echo \"<p>Cod. Autorizacao : \".$codAutorizacao.\"</p>\";\r\n    }else{\r\n      echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n    }\r\n\r\n    if ($objResponse->captura) {\r\n      $mensagem = $objResponse->captura->mensagem;\r\n      echo \"<p style='color:blue'>\".$mensagem.\"</p>\";\r\n    }else{\r\n      echo \"<p style='color:blue'>Clique <a href=./captura.php?id_transacao=\".$id_transacao.\" >aqui</a> para capturar</p>\";\r\n    }\r\n\r\n    echo \"<p>Clique <a href='./consulta.php?id_transacao=\".$id_transacao.\"'>aqui</a> para consultar</p>\";\r\n  }else{\r\n    $codResposta = $objResponse->codResposta;\r\n    $message = $objResponse->message;\r\n    echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n  }\r\n\r\n}\r\n```\r\n\r\n```python\r\nimport kittn\r\n\r\napi = kittn.authorize('meowmeowmeow')\r\napi.kittens.get()\r\n```\r\n\r\n> xml=\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<transacao versao=\"1.1.2\">\r\n   <usuario>demo</usuario>\r\n   <token>3366</token>\r\n   <numeroDocumento>123456</numeroDocumento>\r\n   <tipoOperacao>1</tipoOperacao>\r\n   <valorTransacao>1000</valorTransacao>\r\n   <qtdeParcelas>1</qtdeParcelas>\r\n   <moeda>986</moeda>\r\n   <captura>N</captura>\r\n   <cartao>\r\n      <numeroCartao>4012001038443335</numeroCartao>\r\n      <mesValidade>01</mesValidade>\r\n      <anoValidade>2015</anoValidade>\r\n      <codigoSeguranca>123</codigoSeguranca>\r\n      <bandeira>VISA</bandeira>\r\n   </cartao>\r\n   <comprador>\r\n      <enderecoIP>127.0.0.1</enderecoIP>\r\n      <nomePortadorCartao>Portador</nomePortadorCartao>\r\n      <cpfPortadorCartao>12345678909</cpfPortadorCartao>\r\n      <dataNascimentoPortadorCartao>01012001</dataNascimentoPortadorCartao>\r\n   </comprador>\r\n</transacao>\r\n```\r\n\r\nEsse endpoint efetua uma autorização na rede adquirente.\r\n\r\n\r\n### Requisição\r\n\r\n`POST https://www.ntk2all.com.br/httpRoteador/aprovacao`\r\n\r\n### Método de Envio\r\n\r\n`POST /httpRoteador/aprovacao HTTP/1.1` \r\n\r\n`Host: www.ntk2all.com.br`\r\n\r\n`Content-Type: application/x-www-form-urlencoded`\r\n\r\n`Content-Length: length`\r\n\r\n\r\n### TAGS XML PARA REQUISIÇÃO\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\ntransacao | No Raiz | SIM | 1 | Tag principal do XML. | Atributos: versao (tipo: String) Contém as tags usuário, token, numeroDocumento, desc-venda, tipoOperacao, valorTransacao, qtdeParcelas, moeda, captura, tipoParcelamento, cartão e comprador.\r\nusuario | String | SIM | 1 | Nome do usuário para a transação |\r\ntoken | String | SIM | 1 | Token do usuário para a transação |\r\nnumeroDocumento | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\ndesc-venda | String | NAO | 0 até 1 | Descrição da Venda |\r\ntipoOperacao | String | NAO | 0 até 1 | Informa código do produto | Somente serão aceitos os seguintes valores: 1,2,3,4 e 5. Atualmente o significado dos valores usados é: 1. Crédito à Vista 2. Débito 3. Parcelado pela Loja 4. Parcelado pela Administradora\r\nvalorTransacao | Decimal | SIM | 1 | Valor da Transação |\r\nparcelamentoAdm | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nqtdeParcelas | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nmoeda | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ncaptura | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ntipoParcelamento | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ncartao | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nnumeroCartao | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nmesValidade | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nanoValidade | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ncodigoSeguranca | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nbandeira | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ncomprador | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nenderecoIP | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nnomePortadorCartao | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ncpfPortadorCartao | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\ndataNascimento | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\nPortadorCartao | String | SIM | 1 | XXXXXXXXXXXXXXXXXXX |\r\n\r\n\r\n### Retornos\r\n\r\n> Transação autorizada e não capturada\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <autorizacao>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <message>Transação autorizada</message>\r\n      <codAutorizacao>123456</codAutorizacao>\r\n      <codResposta>00</codResposta>\r\n      <tid>1006993069062C8E1001</tid>\r\n      <numeroDocumento>123456</numeroDocumento>\r\n   </autorizacao>\r\n</retorno-transacao>\r\n```\r\n\r\n> Transação autorizada e capturada\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <autorizacao>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <message>Transação autorizada</message>\r\n      <codAutorizacao>123456</codAutorizacao>\r\n      <codResposta>00</codResposta>\r\n      <tid>1006993069062C8E1001</tid>\r\n      <numeroDocumento>123456</numeroDocumento>\r\n   </autorizacao>\r\n   <captura>\r\n      <mensagem>Transacao capturada com sucesso</mensagem>\r\n      <valor>1000</valor>\r\n   </captura>\r\n</retorno-transacao>\r\n```\r\n\r\n> Transação negada\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <autorizacao>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <message>Transação negada</message>\r\n      <codAutorizacao>null</codAutorizacao>\r\n      <codResposta>99</codResposta>\r\n      <tid>1006993069062C8E1001</tid>\r\n      <numeroDocumento>123456</numeroDocumento>\r\n   </autorizacao>\r\n</retorno-transacao>\r\n```\r\n\r\n> Falha\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<erro>\r\n   <codigo>001</codigo>\r\n   <mensagem><![CDATA[cvc-fractionDigits-valid: Value '9.99' has 2 fraction\r\ndigits, but the number of fraction digits has been limited to 0.]]></mensagem>\r\n</erro>\r\n```\r\n\r\n### TAGS XML DE RETORNOS\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\nretorno_transacao | No Raiz | SIM | 1 | Tag principal do XML. | XXXXXXXXX\r\nautorizacao | String | SIM | 1 | Nome do usuário para a transação |\r\nid_transacao | String | SIM | 1 | Token do usuário para a transação |\r\nmessage | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\ncodAutorizacao | String | NAO | 0 até 1 | Descrição da Venda |\r\ncodAutorizacao | String | NAO | 0 até 1 | Informa código do produto | XXXXXXXXX\r\ncodResposta | String | SIM | 1 | Valor da Transação |\r\ntid | String | SIM | 1 | Valor da Transação |\r\nnumeroDocumento | String | SIM | 1 | Valor da Transação |\r\ncaptura | String | SIM | 1 | Valor da Transação |\r\n\r\n## Consulta\r\n\r\n```php\r\nheader('Content-Type: text/html; charset=utf-8');\r\n\r\n//PRODUÇÃO\r\n/*\r\n$urlGate2all = 'https://ntk2all.com.br';\r\n*/\r\n\r\n$urlGate2all = 'http://cert.gate2all.com.br';\r\n$usuarioGate2all = 'demo';\r\n$tokenGate2all = '3366';\r\n\r\n$id_transacao = $_GET['id_transacao'];\r\n\r\n$xmlGate2all = '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\r\n<transacao>\r\n  <usuario>'.$usuarioGate2all.'</usuario>\r\n  <token>'.$tokenGate2all.'</token>\r\n  <id_transacao>'.$id_transacao.'</id_transacao>\r\n</transacao>';\r\n\r\n$curl = curl_init();\r\n\r\ncurl_setopt_array($curl, array(\r\n  CURLOPT_URL => $urlGate2all.\"/consulta\",\r\n  CURLOPT_CUSTOMREQUEST => \"POST\",\r\n  CURLOPT_HTTPHEADER => array(\"content-type: application/x-www-form-urlencoded\"),\r\n  CURLOPT_POSTFIELDS => 'xml='.$xmlGate2all,\r\n  CURLOPT_TIMEOUT => 90,\r\n  CURLOPT_RETURNTRANSFER => true,\r\n));\r\n\r\n$response = curl_exec($curl);\r\n$err = curl_error($curl);\r\n\r\ncurl_close($curl);\r\n\r\nif ($err) {\r\n  echo \"<p>cURL Error #:\".$err.\"</p>\";\r\n} else {\r\n  echo \"<h3>Response: </h3>\";\r\n  highlight_string($response);\r\n\r\n  $objResponse = simplexml_load_string($response);\r\n  if ($objResponse->transacao) {\r\n    $codResposta = $objResponse->transacao->codResposta;\r\n    $status = $objResponse->transacao->status;\r\n    if ($codResposta == \"00\") {\r\n      echo \"<p style='color:green'>\".$codResposta.\" : \".$status.\"</p>\";\r\n\r\n      $tid = $objResponse->transacao->tid;\r\n      echo \"<p>Ref. Host : \".$tid.\"</p>\";\r\n      $codAutorizacao = $objResponse->transacao->codAutorizacao;\r\n      echo \"<p>Cod. Autorizacao : \".$codAutorizacao.\"</p>\";\r\n    }else{\r\n      echo \"<p style='color:red'>\".$codResposta.\" : \".$status.\"</p>\";\r\n    }\r\n\r\n    if ($objResponse->transacao->credito->capturada == \"N\") {\r\n      echo \"<p style='color:blue'>Clique <a href=./captura.php?id_transacao=\".$id_transacao.\" >aqui</a> para capturar</p>\";\r\n    }else{\r\n      echo \"<p style='color:blue'>Transação já capturada</p>\";\r\n    }\r\n\r\n    if ($objResponse->transacao->credito->cancelada == \"N\") {\r\n      echo \"<p style='color:red'>Clique <a href=./cancelamento.php?id_transacao=\".$id_transacao.\" >aqui</a> para cancelar</p>\";\r\n    }else{\r\n      echo \"<p style='color:red'>Transação já cancelada</p>\";\r\n    }\r\n  }else{\r\n    $codResposta = $objResponse->codResposta;\r\n    $message = $objResponse->message;\r\n    echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n  }\r\n\r\n}\r\n\r\necho \"<p>Clique <a href='./intencao.php' target='_blank'>aqui</a> para realizar uma nova transação</p>\";\r\n```\r\n\r\n```python\r\nimport kittn\r\n\r\napi = kittn.authorize('meowmeowmeow')\r\napi.kittens.get()\r\n```\r\n\r\n> xml=\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<transacao versao=\"1.1.2\">\r\n   <usuario>demo</usuario>\r\n   <token>3366</token>\r\n   <id_transacao>d8ad055e-3c41-45c9-9ee6-5d6ada532552</id_transacao>\r\n   <id_transacao>515650e7-596d-45cc-b0e3-71cc3dbcad55</id_transacao>\r\n</transacao>\r\n```\r\n\r\nEsse endpoint efetua uma consulta no gateway.\r\n\r\n\r\n### Requisição\r\n\r\n`POST https://www.ntk2all.com.br/httpRoteador/consulta`\r\n\r\n### Método de Envio\r\n\r\n`POST /httpRoteador/consulta HTTP/1.1` \r\n\r\n`Host: www.ntk2all.com.br`\r\n\r\n`Content-Type: application/x-www-form-urlencoded`\r\n\r\n`Content-Length: length`\r\n\r\n\r\n### TAGS XML PARA REQUISIÇÃO\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\ntransacao | No Raiz | SIM | 1 | Tag principal do XML. | Atributos: versao (tipo: String) Contém as tags usuário, token, numeroDocumento, desc-venda, tipoOperacao, valorTransacao, qtdeParcelas, moeda, captura, tipoParcelamento, cartão e comprador.\r\nusuario | String | SIM | 1 | Nome do usuário para a transação |\r\ntoken | String | SIM | 1 | Token do usuário para a transação |\r\nid_transacao | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\n\r\n\r\n### Retornos\r\n\r\n> o exemplo abaixo temos o retorno de duas transações.\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno>\r\n   <transacao>\r\n      <id_transacao>515650e7-596d-45cc-b0e3-71cc3dbcad55</id_transacao>\r\n      <numeroDocumento>123456</numeroDocumento>\r\n      <valorTransacao>10.00</valorTransacao>\r\n      <qtdparcelas>1</qtdparcelas>\r\n      <captura>S</captura>\r\n      <codAutorizacao>123456</codAutorizacao>\r\n      <codResposta>00</codResposta>\r\n      <tid>10069930690562631001</tid>\r\n      <cartao>\r\n         <bandeira>VISA</bandeira>\r\n      </cartao>\r\n      <comprador>\r\n         <enderecoIP />\r\n         <portadorCartao />\r\n         <cpfPortadorCartao />\r\n      </comprador>\r\n   </transacao>\r\n   <transacao>\r\n      <id_transacao>d8ad055e-3c41-45c9-9ee6-5d6ada532552</id_transacao>\r\n      <numeroDocumento>123456</numeroDocumento>\r\n      <valorTransacao>10.00</valorTransacao>\r\n      <qtdparcelas>1</qtdparcelas>\r\n      <captura>N</captura>\r\n      <codAutorizacao>123456</codAutorizacao>\r\n      <codResposta>00</codResposta>\r\n      <tid>10069930690562631009</tid>\r\n      <cartao>\r\n         <bandeira>MASTERCARD</bandeira>\r\n      </cartao>\r\n      <comprador>\r\n         <enderecoIP />\r\n         <portadorCartao />\r\n         <cpfPortadorCartao />\r\n      </comprador>\r\n   </transacao>\r\n</retorno>\r\n```\r\n\r\n### TAGS XML DE RETORNOS\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\ntransacao | No Raiz | SIM | 1 | Tag principal do XML. | XXXXXXXXX\r\nid_transacao | String | SIM | 1 | Nome do usuário para a transação |\r\nnumeroDocumento | String | SIM | 1 | Token do usuário para a transação |\r\nvalorTransacao | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\nqtdparcelas | String | NAO | 0 até 1 | Descrição da Venda |\r\ncaptura | String | NAO | 0 até 1 | Informa código do produto | XXXXXXXXX\r\ncodResposta | String | SIM | 1 | Valor da Transação |\r\ntid | String | SIM | 1 | Valor da Transação |\r\ncartao | String | SIM | 1 | Valor da Transação |\r\nbandeira | String | SIM | 1 | Valor da Transação |\r\ncomprador | String | SIM | 1 | Valor da Transação |\r\nenderecoIP | String | SIM | 1 | Valor da Transação |\r\nportadorCartao | String | SIM | 1 | Valor da Transação |\r\ncpfPortadorCartao | String | SIM | 1 | Valor da Transação |\r\n\r\n\r\n## Captura\r\n\r\n```php\r\n//PRODUÇÃO\r\n/*\r\n$urlGate2all = 'https://ntk2all.com.br';\r\n*/\r\n\r\n$urlGate2all = 'http://cert.gate2all.com.br';\r\n$usuarioGate2all = 'demo';\r\n$tokenGate2all = '3366';\r\n\r\n$id_transacao = $_GET['id_transacao'];\r\n\r\n$xmlGate2all = '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\r\n<transacao>\r\n  <usuario>'.$usuarioGate2all.'</usuario>\r\n  <token>'.$tokenGate2all.'</token>\r\n  <id_transacao>'.$id_transacao.'</id_transacao>\r\n</transacao>';\r\n\r\n$curl = curl_init();\r\n\r\ncurl_setopt_array($curl, array(\r\n  CURLOPT_URL => $urlGate2all.\"/captura\",\r\n  CURLOPT_CUSTOMREQUEST => \"POST\",\r\n  CURLOPT_HTTPHEADER => array(\"content-type: application/x-www-form-urlencoded\"),\r\n  CURLOPT_POSTFIELDS => 'xml='.$xmlGate2all,\r\n  CURLOPT_TIMEOUT => 90,\r\n  CURLOPT_RETURNTRANSFER => true,\r\n));\r\n\r\n$response = curl_exec($curl);\r\n$err = curl_error($curl);\r\n\r\ncurl_close($curl);\r\n\r\nif ($err) {\r\n  echo \"<p>cURL Error #:\".$err.\"</p>\";\r\n} else {\r\n  echo \"<h3>Response: </h3>\";\r\n  highlight_string($response);\r\n\r\n  $objResponse = simplexml_load_string($response);\r\n  if ($objResponse->captura) {\r\n    $codResposta = $objResponse->captura->codResposta;\r\n    $message = $objResponse->captura->message;\r\n    if ($codResposta == \"00\") {\r\n      echo \"<p style='color:green'>\".$codResposta.\" : \".$message.\"</p>\";\r\n\r\n      $tid = $objResponse->captura->tid;\r\n      echo \"<p>Ref. Host : \".$tid.\"</p>\";\r\n    }else{\r\n      echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n    }\r\n  }else{\r\n    $codResposta = $objResponse->codResposta;\r\n    $message = $objResponse->message;\r\n    echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n  }\r\n\r\n}\r\n\r\necho \"<p>Clique <a href='./consulta.php?id_transacao=\".$id_transacao.\"'>aqui</a> para consultar</p>\";\r\n```\r\n\r\n```python\r\nimport kittn\r\n\r\napi = kittn.authorize('meowmeowmeow')\r\napi.kittens.get()\r\n```\r\n\r\n> xml=\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<transacao versao=\"1.1.2\">\r\n   <usuario>demo</usuario>\r\n   <token>3366</token>\r\n   <id_transacao>25a433ef-1869-4b33-b8dc-0f7e4a3ff3c6</id_transacao>\r\n   <vl_captura>999</vl_captura>\r\n</transacao>\r\n```\r\n\r\nEsse endpoint efetua a captura da transação\r\n\r\n\r\n### Requisição\r\n\r\n`POST https://www.ntk2all.com.br/httpRoteador/captura`\r\n\r\n### Método de Envio\r\n\r\n`POST /httpRoteador/captura HTTP/1.1` \r\n\r\n`Host: www.ntk2all.com.br`\r\n\r\n`Content-Type: application/x-www-form-urlencoded`\r\n\r\n`Content-Length: length`\r\n\r\n\r\n### TAGS XML PARA REQUISIÇÃO\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\ntransacao | No Raiz | SIM | 1 | Tag principal do XML. | XXXXXXXX\r\nusuario | String | SIM | 1 | Nome do usuário para a transação |\r\ntoken | String | SIM | 1 | Token do usuário para a transação |\r\nid_transacao | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\nvl_captura | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\n\r\n\r\n### Retornos\r\n\r\n> Captura realizada com sucesso\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <captura>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <tid>1006993069062C8E1001</tid>\r\n      <message>Transacao capturada com sucesso</message>\r\n      <valor>1000</valor>\r\n      <codResposta>00</codResposta>\r\n   </captura>\r\n</retorno-transacao>\r\n```\r\n\r\n> Caso a transação já tenha sido capturada previamente o retorno será:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <captura>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <tid>1006993069062C8E1001</tid>\r\n      <message>O status 'Capturada' não permite captura.</message>\r\n      <codResposta>030</codResposta>\r\n   </captura>\r\n</retorno-transacao>\r\n```\r\n> Caso a transação não tenha sido autorizada o retorno será:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <captura>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <tid>1006993069062C8E1001</tid>\r\n      <message>O status 'não autorizada' não permite captura.</message>\r\n      <codResposta>030</codResposta>\r\n   </captura>\r\n</retorno-transacao>\r\n```\r\n\r\n### TAGS XML DE RETORNOS\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\nretorno-transacao | No Raiz | SIM | 1 | Tag principal do XML. | XXXXXXXXX\r\ncaptura | String | SIM | 1 | Nome do usuário para a transação |\r\nid_transacao | String | SIM | 1 | Token do usuário para a transação |\r\ntid | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\nmessage | String | NAO | 0 até 1 | Descrição da Venda |\r\nvalor | String | NAO | 0 até 1 | Informa código do produto | XXXXXXXXX\r\ncodResposta | String | SIM | 1 | Valor da Transação |\r\n\r\n## Cancelamento\r\n\r\n```php\r\n//PRODUÇÃO\r\n/*\r\n$urlGate2all = 'https://ntk2all.com.br';\r\n*/\r\n\r\n$urlGate2all = 'http://cert.gate2all.com.br';\r\n$usuarioGate2all = 'demo';\r\n$tokenGate2all = '3366';\r\n\r\n$id_transacao = $_GET['id_transacao'];\r\n\r\n$xmlGate2all = '<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\r\n<transacao>\r\n  <usuario>'.$usuarioGate2all.'</usuario>\r\n  <token>'.$tokenGate2all.'</token>\r\n  <id_transacao>'.$id_transacao.'</id_transacao>\r\n</transacao>';\r\n\r\n$curl = curl_init();\r\n\r\ncurl_setopt_array($curl, array(\r\n  CURLOPT_URL => $urlGate2all.\"/cancelamento\",\r\n  CURLOPT_CUSTOMREQUEST => \"POST\",\r\n  CURLOPT_HTTPHEADER => array(\"content-type: application/x-www-form-urlencoded\"),\r\n  CURLOPT_POSTFIELDS => 'xml='.$xmlGate2all,\r\n  CURLOPT_TIMEOUT => 90,\r\n  CURLOPT_RETURNTRANSFER => true,\r\n));\r\n\r\n$response = curl_exec($curl);\r\n$err = curl_error($curl);\r\n\r\ncurl_close($curl);\r\n\r\nif ($err) {\r\n  echo \"<p>cURL Error #:\".$err.\"</p>\";\r\n} else {\r\n  echo \"<h3>Response: </h3>\";\r\n  highlight_string($response);\r\n\r\n  $objResponse = simplexml_load_string($response);\r\n  if ($objResponse->cancelamento) {\r\n    $codResposta = $objResponse->cancelamento->codResposta;\r\n    $message = $objResponse->cancelamento->message;\r\n    if ($codResposta == \"00\") {\r\n      echo \"<p style='color:green'>\".$codResposta.\" : \".$message.\"</p>\";\r\n\r\n      $tid = $objResponse->cancelamento->tid;\r\n      echo \"<p>Ref. Host : \".$tid.\"</p>\";\r\n    }else{\r\n      echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n    }\r\n  }else{\r\n    $codResposta = $objResponse->codResposta;\r\n    $message = $objResponse->message;\r\n    echo \"<p style='color:red'>\".$codResposta.\" : \".$message.\"</p>\";\r\n  }\r\n\r\n}\r\n\r\necho \"<p>Clique <a href='./consulta.php?id_transacao=\".$id_transacao.\"'>aqui</a> para consultar</p>\";\r\n```\r\n\r\n```python\r\nimport kittn\r\n\r\napi = kittn.authorize('meowmeowmeow')\r\napi.kittens.get()\r\n```\r\n\r\n> xml=\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<transacao versao=\"1.1.2\">\r\n   <usuario>demo</usuario>\r\n   <token>3366</token>\r\n   <id_transacao>25a433ef-1869-4b33-b8dc-0f7e4a3ff3c6</id_transacao>\r\n   <valorTransacao>999</valorTransacao>\r\n</transacao>\r\n```\r\n\r\nEsse endpoint efetua o cancelamento da transação\r\n\r\n\r\n### Requisição\r\n\r\n`POST https://www.ntk2all.com.br/httpRoteador/cancelamento`\r\n\r\n### Método de Envio\r\n\r\n`POST /httpRoteador/cancelamento HTTP/1.1` \r\n\r\n`Host: www.ntk2all.com.br`\r\n\r\n`Content-Type: application/x-www-form-urlencoded`\r\n\r\n`Content-Length: length`\r\n\r\n\r\n### TAGS XML PARA REQUISIÇÃO\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\ntransacao | No Raiz | SIM | 1 | Tag principal do XML. | XXXXXXXX\r\nusuario | String | SIM | 1 | Nome do usuário para a transação |\r\ntoken | String | SIM | 1 | Token do usuário para a transação |\r\nid_transacao | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\nvalorTransacao | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\n\r\n\r\n### Retornos\r\n\r\n> Sucesso\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <cancelamento>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <tid>1175</tid>\r\n      <message>Transação desfeita</message>\r\n      <codResposta>00</codResposta>\r\n   </cancelamento>\r\n</retorno-transacao>\r\n```\r\n\r\n> Erro - Prazo de cancelamento vencido\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <cancelamento>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <tid>1175</tid>\r\n      <message>Nao foi possivel cancelar a transacao</message>\r\n      <codResposta>040</codResposta>\r\n   </cancelamento>\r\n</retorno-transacao>\r\n```\r\n> Transação já cancelada\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<retorno-transacao>\r\n   <cancelamento>\r\n      <id_transacao>36c449e1-bd14-4aeb-8d5a-302a72e25181</id_transacao>\r\n      <tid>1175</tid>\r\n      <message>Transação já cancelada</message>\r\n      <codResposta>041</codResposta>\r\n   </cancelamento>\r\n</retorno-transacao>\r\n```\r\n\r\n### TAGS XML DE RETORNOS\r\n\r\nTag | Tipo | Obrig. | Ocorrências | Descrição | Observações |\r\n--------- | ------- | ----------- | ----------- | ----------- | ----------- |\r\nretorno-transacao | No Raiz | SIM | 1 | Tag principal do XML. | XXXXXXXXX\r\ncancelamento | String | SIM | 1 | Nome do usuário para a transação |\r\nid_transacao | String | SIM | 1 | Token do usuário para a transação |\r\ntid | String | SIM | 1 | Numero do Documento | O valor desta tag deve ser enviado pela loja, para controle interno da transação.\r\nmessage | String | NAO | 0 até 1 | Descrição da Venda |\r\nvalor | String | NAO | 0 até 1 | Informa código do produto | XXXXXXXXX\r\ncodResposta | String | SIM | 1 | Valor da Transação |\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}